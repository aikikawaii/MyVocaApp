workflows:
  my-voca-app-ios:
    name: My Voca App iOS Build
    instance_type: mac_mini_m2
    environment:
      node: latest
      xcode: latest
    scripts:
      - name: Install dependencies
        script: |
          npm install
          npm install @capacitor/ios
      - name: Add iOS platform
        script: |
          chmod +x node_modules/.bin/cap
          npx cap add ios
          npx cap sync ios
      - name: Build iOS App (Unsigned)
        script: |
          cd ios/App
          xcodebuild build -workspace App.xcworkspace -scheme App -destination generic/platform=iOS CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO
    artifacts:
      - /Users/builder/clone/ios/App/build/Release-iphoneos/*.app